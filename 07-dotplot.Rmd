# Dotplot {#dotplot}

## At the Beginning

```r
# library(BetterVis)
library(MetBrewer)
library(RColorBrewer)
library(MASS)
```

## BetterVis_DotPlot_Heatmap

This function combines a dot plot with elements of a heatmap.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_DotPlot_Heatmap_example", package="BetterVis")
df_dot_heatmap <- matrix(rnorm(17 * 13, 1, 0.8), nrow = 17, ncol = 13)
rownames(df_dot_heatmap) <- paste("Gene", 1:17)
colnames(df_dot_heatmap) <- paste("CellType", 1:13)

row_colors<-c(brewer.pal(9,"Set3"),brewer.pal(8,"Set2"))
col_colors<-c(brewer.pal(8,"Set1"),brewer.pal(5,"Set2"))
```

### Usage Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_DotPlot_Heatmap(df_dot_heatmap, scale = FALSE, col.min=0, col.max = 2, show.noexpr.dots = TRUE,
  data.colors = c("#1289B2","#FCF6AF","#E53849"),
  dots.size = 3, dots.type = "square root", inner.border = FALSE,
  cluster.features=FALSE, cluster.idents = FALSE, idents.kmeans = 1, features.kmeans = 1,
  row.names.side = "right", idents.names.size = 10,
  column.names.side = "top", column.names.angle=45, features.names.size = 10,
  right.annotation = FALSE, bottom.annotation = FALSE, top.annotation = TRUE,
  row_annotation_color = row_colors, col_annotation_color = col_colors,
  show.data.legend = TRUE, row_annotation_legend = TRUE, row_annotation_legend_title = "Rows",
  col_annotation_legend = TRUE, col_annotation_legend_title = "Cols",
  zscore.legend = TRUE, zscore.legend.side = "bottom",
  legend.title.size = 10, legend.text.size = 10,
  row.split = c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5),
  col.split = c(4,4,4,5,3,1,1,1,1,1,2,5,2),
  keep_rownames_order = TRUE, border_gp_control = FALSE)
```
![](images/dotplot_heatmap.png)

### Parameter explanation
**(Full parameter list as you provided)...**

---

## BetterVis_Dotplot_Beeswarm

This function provides a convenient way to create beeswarm plots.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_Dotplot_Beeswarm_example", package="BetterVis")
df_beeswarm <- Cars93[, c("Type", "MPG.city")]
```

### Simple Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Dotplot_Beeswarm(data = df_beeswarm, x_var = "Type", y_var = "MPG.city",
  color = c("#68d0ce", "#f4a4c9", "#4955d0", "#e09a2a", "#de6a73","firebrick"),
  ylim =c(10,60), y_break = 10,
  comparison_col = "Type", comparison_group = list(c("Compact","Large"),c("Midsize","Large"),c("Small","Van")), comparison_method = "t.test")
```

### Advanced Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Dotplot_Beeswarm(data = df_beeswarm, x_var = "Type", y_var = "MPG.city",
  color = c("#68d0ce", "#f4a4c9", "#4955d0", "#e09a2a", "#de6a73","firebrick"),
  ylim =c(10,60), y_break = 10,
  point_size = 2, point_alpha = 0.6,
  median_bar = TRUE, border=TRUE,
  title = "Title", x_title = "Type", y_title = "MPG.city",
  sig_symbol = TRUE, sig_type="SYMBOL",
  comparison_col = "Type", comparison_group = list(c("Compact","Large"),c("Midsize","Large"),c("Small","Van")), comparison_method = "t.test")
```

### Parameter explanation
**(Full parameter list as you provided)...**

---

## BetterVis_Dotplot_Mixbar

This function enhances a standard grouped dot plot by adding marginal bar charts.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_Dotplot_Mixbar_example", package="BetterVis")
df_mixbar <- data.frame(
  bill_length_mm = rnorm(150, 43, 5),
  bill_depth_mm = rnorm(150, 17, 2),
  species = rep(c("Adelie", "Chinstrap", "Gentoo"), each=50),
  body_mass_g = rnorm(150, 4200, 800)
)
```

### Simple Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Dotplot_Mixbar(df = df_mixbar, x_var = "bill_length_mm", y_var = "bill_depth_mm", classified_var = "species", size_var = "body_mass_g",
  color =  c("#FBA72A", "#78B7C5", "#7294D4"),
  x_title = "Bill Length", y_title = "Bill Depth")
```

### Advanced Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Dotplot_Mixbar(df = df_mixbar, x_var = "bill_length_mm", y_var = "bill_depth_mm", 
  classified_var = "species", size_var = "body_mass_g", color =c("#FBA72A", "#78B7C5", "#7294D4"),
  point_shape = 16, point_size = 4, 
  error_bar = TRUE, errorbar_width = 0.6, errorbar_size = 1, 
  legend = FALSE, title = "", x_title = "Bill Length", 
  y_title = "Bill Depth", legend_title = "Species",
  theme_custom = theme(axis.title.x = element_text(size = 15)), guides_custom=guides(color="none",fill="none"), Mixbar = TRUE)
```

### Parameter explanation
**(Full parameter list as you provided)...**

---

## BetterVis_Dotplot_Multifacet

Streamlines the creation of advanced visualizations for both standard and faceted dot plots.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_Dotplot_Multifacet_example", package="BetterVis")
df_multifacet <- iris
```

### Simple Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Dotplot_Multifacet(df = df_multifacet, classified_var = "Species", color = c("#BEBADA", "#80B1D3", "#FDB462"), ncol = 4)
```

### Advanced Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Dotplot_Multifacet(
  df = df_multifacet, classified_var = "Species", 
  color = c("#BEBADA", "#80B1D3", "#FDB462"),
  ncol = 4,
  strokeSize = 0.2, pointSize = 3, strokeColor = 'gray30', alpha = 0.6,
  legend_title  = "Species", legend_title_size = 12, legend_text_size = 12,
  x_text_angle = 0, x_text_size = 12, x_title_size = 12,
  y_text_size = 12, y_title_size = 12,
  theme_custom = theme(axis.text = element_text(face="bold")),
  guides_custom = NULL)
```

### Parameter explanation
**(Full parameter list as you provided)...**

---

## BetterVis_Dotplot_Smoothline

For correlation and regression analyses, a scatter plot with a fitted line is essential.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_Dotplot_Smoothline_example", package="BetterVis")
df_smoothline <- iris
```

### Simple Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Dotplot_Smoothline(data = df_smoothline, x_var = "Sepal.Width", y_var = "Sepal.Length", classified_var = "Species", 
  size_var = "Petal.Length", color = c("#FBA72A", "#78B7C5", "#7294D4"), cor_position = c(3.8, 8))
```

### Advanced Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Dotplot_Smoothline(data = df_smoothline, x_var = "Sepal.Width", y_var = "Sepal.Length", classified_var = "Species", 
  size_var = "Petal.Length", color = c("#BEBADA", "#80B1D3", "#FDB462"),  point_size = 5,
  smoothline = TRUE, smoothline_width = 2, smoothline_color = "#FB8072", 
  cor_test = TRUE, cor_method = "spearman", cor_color = "black", cor_position = c(2.2, 8),
  title = "Title", x_title = "Sepal.Width ", y_title = "Sepal.Length", 
  legend = TRUE, legend_title = "Species", legend_position = "right",
  global_size_adjust = 1)
```

### Parameter explanation
**(Full parameter list as you provided)...**

---

## BetterVis_Dotplot_Ternary

The ternary plot is the ideal choice for visualizing the proportional relationship between three variables.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_Dotplot_Ternary_example", package="BetterVis")
set.seed(123)
df_ternary <- data.frame(
  x = runif(50, 0, 1),
  y = runif(50, 0, 1),
  z = runif(50, 0, 1),
  size = runif(50, 1, 10)
)
# Normalize to sum to 1
df_ternary <- df_ternary / rowSums(df_ternary[,1:3])
df_ternary$size <- df_ternary$size * 10
```

### Simple Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Dotplot_Ternary(data = df_ternary, x_var = "x", y_var = "y", z_var = "z", size_var = "size",
  color = MetBrewer::met.brewer("Hiroshige"), all_text_adjust = 1.5)
```

### Advanced Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Dotplot_Ternary(data = df_ternary, x_var = "x", y_var = "y", z_var = "z", size_var = "size",
  color = MetBrewer::met.brewer("Hiroshige"),
  point_size = 3, point_alpha = 0.6, 
  border_size = 1.2, border_color = c("#68d0ce", "#e09a2a", "#de6a73"),
  legend = TRUE, all_text_adjust = 1.3,
  title = "Title", subtitle = "Sub_Title", x_title = "X_Title", y_title = "Y_Title", z_title = "Z_Title")
```

### Parameter explanation
**(Full parameter list as you provided)...**
