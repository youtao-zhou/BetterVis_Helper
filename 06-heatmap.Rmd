# Heatmap {#heatmap}

## At the Beginning

To use these features, the BetterVis functions must be loaded beforehand.

```r
# library(BetterVis)
library(MetBrewer)
library(vegan)
```

## BetterVis_Heatmap_Bicontinuous

BetterVis_Heatmap_Bicontinuous is the best choice for creating heatmaps with a diverging color scale, which is perfect for representing continuous data that spans two extremes from a central point.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_Heatmap_Bicontinuous_example", package="BetterVis")
df_bicontinuous <- expand.grid(ID = 1:10, name = letters[1:10])
df_bicontinuous$value <- rnorm(100)
```

### Simple Example
```r
BetterVis_Heatmap_Bicontinuous(data = df_bicontinuous, x_var = "ID", y_var = "name", fill_var = "value", legend_title = "Change")
```
![](images/heatmap_bicontinuous_simple.png)

### Advanced Example
```r
BetterVis_Heatmap_Bicontinuous(df_bicontinuous, x_var ="ID", y_var ="name", fill_var ="value", 
  vline_position = 5, hline_position = "e", 
  vline_color = "black", hline_color = "black", hline_linetype = "dashed", 
  heatmap_color =  rev(met.brewer("Hiroshige")), 
  legend_break = 1, legend_title = "Change", legend_position = "bottom", legend_title_position = "top") +
  theme(axis.text = element_text(size = 12))
```
![](images/heatmap_bicontinuous_advanced.png)

### Parameter explanation
**(Full parameter list as you provided)...**

---

## BetterVis_Heatmap_Circle

This function enables the visualization of multiple numeric columns as a series of concentric heatmap rings.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_Heatmap_Circle_example", package="BetterVis")
df_h_circle <- data.frame(
  id = rep(paste("Sample", 1:10), 5),
  name = rep(paste("Feature", 1:5), each = 10),
  value = rnorm(50, 0, 1)
)
```

### Simple Example
```r
BetterVis_Heatmap_Circle(data = df_h_circle, value_var = "value", classified_text_var = "id", classified_value_var = "name")
```

### Advanced Example
```r
BetterVis_Heatmap_Circle(data = df_h_circle, value_var = "value", classified_text_var = "id", classified_value_var = "name",
  heatmap_color = scales::alpha(met.brewer("Hiroshige"), 1),
  text_size = 4, barwidth = 9, barheight = 0.5, legend_break = 1, legend_text_size=12, 
  classified_value_var_label_size = 10)
```

### Parameter explanation
**(Full parameter list as you provided)...**

---

## BetterVis_Heatmap_Common

This function is designed for visualizing a simple, purely numerical matrix.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_Heatmap_Common_example", package="BetterVis")
df_h_common <- as.data.frame(matrix(rnorm(100), 10, 10))
colnames(df_h_common) <- paste("Sample", 1:10)
rownames(df_h_common) <- paste("Gene", 1:10)
```

### Simple Example
```r
BetterVis_Heatmap_Common(df_h_common, trans = FALSE)
```

### Advanced Example
```r
BetterVis_Heatmap_Common(df_h_common, trans = FALSE,
  heatmap_color = met.brewer("Hiroshige"), legend_break = 1,
  legend_position = "top", legend_title = "", legend_text_size = 8, legend_text_bold = TRUE,
  x_text_size = 12, x_text_bold = TRUE, x_text_angle = 90,
  y_text_size = 12, y_text_bold = TRUE)
```

### Parameter explanation
**(Full parameter list as you provided)...**

---

## BetterVis_Heatmap_Mantel

This function explores the relationship between a numerical expression matrix and a categorical phenotype dataset.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_Heatmap_Mantel_example1", package="BetterVis") etc.
expression_data <- as.data.frame(matrix(rnorm(50 * 30), nrow = 50, ncol = 30))
colnames(expression_data) <- paste0("Sample", 1:30)
rownames(expression_data) <- paste0("Gene", 1:50)

phenotype_data <- data.frame(
  row.names = colnames(expression_data),
  stage = sample(c("I", "II", "III", "IV"), 30, replace = TRUE),
  age = rnorm(30, 60, 10),
  gender = sample(c("Male", "Female"), 30, replace = TRUE),
  CA125 = rnorm(30, 35, 15),
  CEA = rnorm(30, 5, 2),
  CA15.3 = rnorm(30, 30, 10)
)
```

### Simple Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Heatmap_Mantel(phenotype_data, expression_data, spec_select=c("stage", "age", "gender", "CA125", "CEA", "CA15.3"))
```

### Advanced Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Heatmap_Mantel(phenotype_data, expression_data, spec_select=c("stage", "age", "gender", "CA125", "CEA", "CA15.3"),
  significant_symbol = TRUE, heatmap_color = brewer.pal(11, "PuOr"), line_size = c(0.5, 1, 2),
  line_color =  c("#E41A1C", "#377EB8", "#4DAF4A"), phenotype_text_size = 4) +
  theme(legend.text = element_text(size=16), legend.title = element_text(size=18))
```

### Parameter explanation
**(Full parameter list as you provided)...**

---

## BetterVis_Heatmap_Multi

This function provides a robust solution for annotating heatmaps with multiple categorical variables.

### Data Input
```r
# Create sample data
# In your project: data("BetterVis_Heatmap_Multi_example", package="BetterVis")
df_h_multi <- as.data.frame(matrix(rnorm(20 * 15), 20, 15))
colnames(df_h_multi) <- paste("Gene", 1:15)
df_h_multi$'case.ID' <- paste("Sample", 1:20)
df_h_multi$'Primary Metastasis' <- sample(c("Primary", "Metastasis"), 20, replace = TRUE)
df_h_multi$'Consensus classification' <- sample(paste("Consensus", 1:5), 20, replace = TRUE)
df_h_multi$'UNC classification' <- sample(c("UNC1", "UNC2", "UNC3"), 20, replace = TRUE)

color_annotation<-list(
  c("#E31A1C","#FDBF6F"),
  c("#A6CEE3","#1F78B4","#B2DF8A","#33A02C","#FB9A99"),
  c("#FF7F00","#CAB2D6")
)
```

### Simple Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Heatmap_Multi(df_h_multi, x_var = "case.ID", number_vars = NULL, annotation_var = c("Primary Metastasis","Consensus classification","UNC classification"),
  color_heatmap = met.brewer("Cassatt1"),
  color_annotation = color_annotation)
```

### Advanced Example
```r
# Note: eval=FALSE as the function is not provided in user files
BetterVis_Heatmap_Multi(df_h_multi, x_var = "case.ID", number_vars = NULL, annotation_var = c("Primary Metastasis","Consensus classification","UNC classification"),
  color_heatmap = met.brewer("Cassatt1"),
  color_annotation = color_annotation,
  legend_heatmap_position = c(1.08,0.7), legend_annotation_position = c(1.22,-4),
  heatmap_plot_margin = unit(c(0, 2, -20, 0.5), "cm"),
  heatmap_theme = theme(axis.text.y = element_text(face="bold")),
  annotation_theme =theme(axis.text.y = element_text(face="bold"),
  legend.title =element_text(face="bold"),
  legend.text =element_text(face="bold")))
```

### Parameter explanation
**(Full parameter list as you provided)...**
